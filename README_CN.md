# ComfyUI-LG_SamplingUtils

![Image](./assets/1.jpg)

**ä¸­æ–‡** | [English](README.md)

---

## æ¦‚è¿°

**ComfyUI-LG_SamplingUtils** æ˜¯ç”± LAOGOU-666 ä¸º ComfyUI è®¾è®¡çš„ç»¼åˆå·¥å…·é›†ï¼Œæä¾›ä¸€ç³»åˆ—å®ç”¨çš„é‡‡æ ·èŠ‚ç‚¹ï¼Œä½¿æ“ä½œæ›´åŠ ç›´è§‚å’Œä¾¿æ·ã€‚æœ¬æ‰©å±•ä¸“æ³¨äºé«˜çº§é‡‡æ ·æŠ€æœ¯ï¼Œç‰¹åˆ«é’ˆå¯¹ ZImage å’Œ Lumina2 ç­‰ Flow Matching æ¨¡å‹è¿›è¡Œäº†ä¼˜åŒ–ã€‚

## åŠŸèƒ½ç‰¹æ€§

æœ¬æ‰©å±•åŒ…å«å››ä¸ªå¼ºå¤§çš„èŠ‚ç‚¹ï¼š

### 1. ğŸˆ ZImage Timestep Noiseï¼ˆæ—¶é—´æ­¥å™ªå£°ï¼‰

åœ¨é‡‡æ ·è¿‡ç¨‹ä¸­å¯¹æ—¶é—´æ­¥æ·»åŠ å™ªå£°æ‰°åŠ¨ï¼Œæ‰“ç ´æ¨¡å‹çš„åŒè´¨åŒ–è¾“å‡ºï¼Œä½¿ä¸åŒç§å­èƒ½äº§ç”Ÿæ›´æ˜æ˜¾çš„å·®å¼‚ã€‚

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- ä¸¤ç§æ¨¡å¼ï¼š`sigma`ï¼ˆä¼ ç»Ÿæ‰©æ•£æ¨¡å‹ï¼‰å’Œ `flow`ï¼ˆFlow Matching æ¨¡å‹ï¼‰
- å¯è°ƒèŠ‚çš„å™ªå£°å¼ºåº¦å’Œåº”ç”¨èŒƒå›´
- å¯é€‰çš„é®ç½©æ”¯æŒï¼Œå®ç°å±€éƒ¨æ•ˆæœ
- åŸºäºç§å­çš„å¯é‡ç°æ€§

**å‚æ•°è¯´æ˜ï¼š**
- `mode`ï¼šé€‰æ‹© `sigma`ï¼ˆä¹˜æ€§å™ªå£°ï¼‰æˆ– `flow`ï¼ˆåŠ æ€§å™ªå£°ï¼‰
- `noise_strength`ï¼šæ§åˆ¶å™ªå£°å¼ºåº¦ï¼ˆ0.0-2.0ï¼‰
- `seed`ï¼šéšæœºç§å­ï¼Œç¡®ä¿å¯é‡ç°
- `start_percent` / `end_percent`ï¼šå®šä¹‰å™ªå£°åº”ç”¨çš„é‡‡æ ·èŒƒå›´
- `mask`ï¼ˆå¯é€‰ï¼‰ï¼šé™åˆ¶æ•ˆæœåˆ°ç‰¹å®šåŒºåŸŸ

### 2. ğŸˆ LG Noise Injectionï¼ˆå™ªå£°æ³¨å…¥ï¼‰

é€šè¿‡ CFG æœºåˆ¶å°†å‚è€ƒå›¾åƒçš„ç‰¹å¾æ³¨å…¥åˆ°ç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œè®©æ¨¡å‹"å­¦ä¹ "å‚è€ƒå›¾åƒçš„ç‰¹å®šå“è´¨ã€‚

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- æ³¨å…¥è¡¨é¢ç»†èŠ‚ï¼Œå¦‚æ°´ç ã€æ±—ç ã€çº¹ç†
- æ·»åŠ æè´¨å±æ€§å’Œåå°„æ•ˆæœ
- æ”¯æŒé®ç½©è¿›è¡Œå®šå‘ç‰¹å¾æ³¨å…¥
- é‡‡æ ·è¿‡ç¨‹ä¸­å¼ºåº¦é€æ¸è¡°å‡

**å‚æ•°è¯´æ˜ï¼š**
- `reference_image`ï¼šåŒ…å«æ‰€éœ€ç‰¹å¾çš„å‚è€ƒå›¾åƒ
- `strength`ï¼šæ³¨å…¥å¼ºåº¦ï¼ˆ0.1-0.2 è½»å¾®ï¼Œ0.2-0.4 æ˜æ˜¾ï¼‰
- `start_percent` / `end_percent`ï¼šå®šä¹‰ç‰¹å¾æ³¨å…¥çš„æ—¶æœº
- `mask`ï¼ˆå¯é€‰ï¼‰ï¼šç™½è‰²åŒºåŸŸæ¥æ”¶ç‰¹å¾æ³¨å…¥

**å˜ä½“ï¼š** ğŸˆ **LG Noise Injection (Latent)** - ç›´æ¥ä½¿ç”¨æ½œåœ¨è¡¨ç¤ºå·¥ä½œï¼Œå¦‚æœæ½œåœ¨ä¸­å­˜åœ¨ `noise_mask` åˆ™è‡ªåŠ¨ä½¿ç”¨ã€‚

### 3. Model Sampling ZImageï¼ˆZImage é‡‡æ ·ï¼‰

è°ƒæ•´ ZImage/Lumina2 æ¨¡å‹çš„é‡‡æ ·å‚æ•°ã€‚

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- ä¸º Flow Matching æ¨¡å‹æä¾›æ­£ç¡®çš„æ—¶é—´æ­¥ç¼©æ”¾
- å¯è°ƒèŠ‚çš„å™ªå£°è°ƒåº¦åç§»
- å…¼å®¹ ZImageã€Lumina2 å’Œ AuraFlow

**å‚æ•°è¯´æ˜ï¼š**
- `shift`ï¼šå™ªå£°è°ƒåº¦åç§»ï¼ˆZImage é»˜è®¤ 3.0ï¼‰
  - `shift=1.0`ï¼šçº¿æ€§è°ƒåº¦
  - `shift>1.0`ï¼šå‘é«˜å™ªå£°åç§»ï¼Œæ—©æœŸæ­¥éª¤æ›´æ¿€è¿›
- `multiplier`ï¼šæ—¶é—´æ­¥ä¹˜æ•°ï¼ˆZImage/AuraFlow ä¸º 1.0ï¼ŒSD3/Flux ä¸º 1000ï¼‰

### 4. Sigmas Editor ğŸšï¸ï¼ˆSigmas ç¼–è¾‘å™¨ï¼‰

äº¤äº’å¼å¯è§†åŒ–ç¼–è¾‘å™¨ï¼Œå®æ—¶è°ƒæ•´ sigmas æ›²çº¿ã€‚

**æ ¸å¿ƒåŠŸèƒ½ï¼š**
- æ‹–æ”¾å¼æ›²çº¿ç¼–è¾‘
- å®æ—¶å¯è§†åŒ–
- å¾®è°ƒå™ªå£°è°ƒåº¦ä»¥è·å¾—æœ€ä½³ç»“æœ

## ç¤ºä¾‹å±•ç¤º

<div align="center">

![Example 1](./assets/01.jpg)
![Example 2](./assets/02.jpg)
![Example 3](./assets/03.jpg)
![Example 4](./assets/04.jpg)
![Example 5](./assets/05.jpg)
![Example 6](./assets/06.jpg)
![Example 7](./assets/07.jpg)
![Example 8](./assets/08.jpg)

</div>

## å®‰è£…æ–¹æ³•

### æ–¹æ³• 1ï¼šComfyUI Managerï¼ˆæ¨èï¼‰

1. æ‰“å¼€ ComfyUI Manager
2. æœç´¢ "ComfyUI-LG_SamplingUtils"
3. ç‚¹å‡»å®‰è£…

### æ–¹æ³• 2ï¼šæ‰‹åŠ¨å®‰è£…

```bash
cd ComfyUI/custom_nodes
git clone https://github.com/LAOGOU-666/ComfyUI-LG_SamplingUtils.git
```

å®‰è£…åé‡å¯ ComfyUIã€‚

## è”ç³»æ–¹å¼

- **å¾®ä¿¡**: wenrulaogou2033
- **Bilibili**: [è€ç‹—_å­¦ä¹ ç¬”è®°](https://space.bilibili.com/175873218?spm_id_from=333.788.0.0)

## ä»“åº“åœ°å€

[https://github.com/LAOGOU-666/ComfyUI-LG_SamplingUtils](https://github.com/LAOGOU-666/ComfyUI-LG_SamplingUtils)

## æ”¯æŒ

å¦‚æœæ‚¨é‡åˆ°ä»»ä½•é—®é¢˜æˆ–æœ‰å»ºè®®ï¼Œè¯·åœ¨ GitHub ä¸Šæäº¤ issueã€‚

## æ›´æ–°æ—¥å¿—

### v1.0.0
- é¦–æ¬¡å‘å¸ƒ
- æ·»åŠ  ZImage Timestep Noise èŠ‚ç‚¹
- æ·»åŠ  LG Noise Injection èŠ‚ç‚¹ï¼ˆå›¾åƒå’Œæ½œåœ¨å˜ä½“ï¼‰
- æ·»åŠ  Model Sampling ZImage èŠ‚ç‚¹
- æ·»åŠ  Sigmas Editor èŠ‚ç‚¹

---

**ä½¿ç”¨ ComfyUI-LG_SamplingUtils æ„‰å¿«åˆ›ä½œï¼ğŸˆ**

